# Node `write_docs` output

- Mode: `text`
- Started at: `2025-12-23T10:40:18.129774`
- Duration: `47508` ms
- Error: `None`

---

# Overview

## Module Overview
The `neurosurfer_tracing_docs` module provides a structured tracing system for tracking steps in workflows. It includes classes for trace logs, steps, contexts, and tracers, along with configuration options for enabling tracing and controlling log output. This module is designed to support logging, rendering, and configuration for tracing workflows, making it easier to track and analyze the execution of steps in a structured manner.

## Key Components
The module includes several key components:
- **TraceLog**: A single log entry inside a traced step.
- **TraceStep**: One traced step in a workflow.
- **TraceStepContext**: A context manager returned by `Tracer.step()`.
- **Tracer**: A unified tracing class for agents and graphs.
- **TracerConfig**: Configuration options for controlling tracing behavior.
- **Span Tracers**: Various span tracers such as `ConsoleTracer`, `LoggerTracer`, `MemorySpanTracer`, and `NullSpanTracer`.

## Usage Scenarios
The tracing module can be used in various scenarios:
- **Logging**: Track and log messages during the execution of steps.
- **Rendering**: Render traces as structured data or formatted text/markdown.
- **Configuration**: Control tracing behavior through configuration options.

---

# Components

## TraceLog
A `TraceLog` is a single log entry inside a traced step. It includes the timestamp, message, data, and type of the log entry. This allows for detailed logging of events during the execution of steps.

## TraceStep
A `TraceStep` represents one traced step in a workflow. It includes attributes such as `step_id`, `kind`, `label`, and `node_id`. This class is flexible enough to cover various types of steps, such as LLM calls, tool calls, and custom steps.

## TraceStepContext
A `TraceStepContext` is a context manager returned by `Tracer.step()`. It records the start and end times of a step, logs messages, and stores inputs and outputs. It also provides methods for adding logs and managing the context of a step.

## Tracer
The `Tracer` class is a unified tracing class for agents and graphs. It provides methods for creating traced steps, logging messages, and rendering traces. The `Tracer` class uses a configured `SpanTracer` to emit human-readable logs.

## TracerConfig
The `TracerConfig` class provides configuration options for controlling tracing behavior. It includes options such as `enabled`, `log_steps`, `max_output_preview_chars`, and other formatting options. This allows for fine-grained control over how tracing is performed and what information is logged.

## Span Tracers
Span tracers are used by the `Tracer` to emit human-readable logs. The available span tracers include:
- **ConsoleTracer**: Writes logs to stdout using `print`.
- **LoggerTracer**: Writes logs to a Python `logging.Logger`.
- **MemorySpanTracer**: Captures span events in-memory.
- **NullSpanTracer**: No-op span tracer that ignores all spans.

---

# Flows

## Tracing Initialization
Tracing starts with the `Tracer` class. The `Tracer` is initialized with a `TracerConfig` object that controls tracing behavior. The `Tracer` can be configured to enable or disable tracing, control logging of steps, and set formatting options.

## Step Context Management
When a step is traced using `Tracer.step()`, a `TraceStepContext` is returned. This context manager records the start and end times of the step, logs messages, and stores inputs and outputs. It also provides methods for adding logs and managing the context of a step.

## Logging and Rendering
During the execution of a step, messages can be logged using the `log()` method of the `TraceStepContext`. These logs are stored in the structured trace result and can be rendered as text or markdown. The `render()` method of the `Tracer` class is used to render the trace results, allowing for easy visualization of the execution flow.

---

# Configuration

## Tracer Configuration
The `TracerConfig` class provides configuration options for controlling tracing behavior. It includes the following key options:
- **enabled**: A boolean indicating whether tracing is enabled.
- **log_steps**: A boolean indicating whether steps should be logged.
- **max_output_preview_chars**: An integer indicating the maximum number of characters for output previews.
- **indent_spaces**: An integer indicating the number of spaces for indentation.
- **show_agent_banner**: A boolean indicating whether to show agent banners.
- **show_synthetic_phase_lines**: A boolean indicating whether to show synthetic phase lines.
- **show_inputs**: A boolean indicating whether to show inputs.
- **show_outputs**: A boolean indicating whether to show outputs.
- **show_logs**: A boolean indicating whether to show logs.
- **include_log_data**: A boolean indicating whether to include log data in logs.

## Configuration Options
The configuration options allow for fine-grained control over how tracing is performed. For example, `enabled` controls whether tracing is enabled, `log_steps` controls whether steps are logged, and `max_output_preview_chars` controls the maximum number of characters for output previews.

## Configuration Best Practices
- **Enable Tracing**: Ensure that tracing is enabled if you need to track and log steps.
- **Control Logging**: Use `log_steps` to control whether steps are logged.
- **Format Output**: Use `indent_spaces`, `show_agent_banner`, and other formatting options to control the appearance of logs.
- **Limit Output**: Use `max_output_preview_chars` to limit the length of output previews.

---

# Examples

## Basic Tracing Example
To trace a step, use the `Tracer.step()` method. This method returns a `TraceStepContext` that can be used to log messages and manage the context of the step.

```python
with tracer.step(kind="llm", label="agent.llm.ask", inputs=inputs) as t:
    res = self.llm.ask(**inputs)
    norm = normalize(res)
    t.add(output=norm, raw=res)
```

## Logging Messages
Messages can be logged during the execution of a step using the `log()` method of the `TraceStepContext`.

```python
t.log(message="Starting step...", type="info")
```

## Rendering Traces
Traces can be rendered as text or markdown using the `render()` method of the `Tracer` class.

```python
trace_rendered = tracer.render(format="markdown")
```

---

# Pitfalls

## Common Pitfalls
- **Tracing Disabled by Default**: Tracing is disabled by default. Ensure that `TracerConfig.enabled` is set to `True` if you need to track and log steps.
- **Output Truncation**: Logs may be truncated if outputs exceed `max_output_preview_chars`. Ensure that `max_output_preview_chars` is set to an appropriate value if you need to log large outputs.
- **Missing Imports**: Ensure that the necessary modules are imported, such as `SpanTracer` and `TracerConfig`, to use the tracing functionality correctly.

## Tracing Disabled by Default
Tracing is disabled by default. To enable tracing, set `TracerConfig.enabled` to `True`.

```python
tracer = Tracer(config=TracerConfig(enabled=True))
```

## Output Truncation
Logs may be truncated if outputs exceed `max_output_preview_chars`. To avoid truncation, increase the value of `max_output_preview_chars`.

```python
tracer = Tracer(config=TracerConfig(max_output_preview_chars=1000))
```

## Missing Imports
Ensure that the necessary modules are imported, such as `SpanTracer` and `TracerConfig`, to use the tracing functionality correctly.

```python
from neurosurfer.tracing.span import SpanTracer
from neurosurfer.tracing.config import TracerConfig
```